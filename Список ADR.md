**ADR-1: Выбор микросервисной архитектуры**

Необходимо обеспечить масштабируемость, независимое развертывание компонентов и гибкость технологического стека.

Решение: принята микросервисная архитектура с разделением на:
  - user-service (аутентификация, профили)
  - training-service (данные тренировок)
  - devices-service (интеграция с фитнес-девайсами)
  - social-service (чаты, группы)
  - notification-service (уведомления)

Обоснование:
1. Позволяет масштабировать компоненты отдельно (например social-service при росте аудитории);
2. Не зависит от единой технологии;
3. Соответствует требованиям к отказоустойчивости.

Последствия:
1. Усложнение мониторинга (необходим Prometheus + Grafana).
2. Требуется Kubernetes для оркестрации.

---

**ADR-2: Использование Multi-Cloud**

Компания не хочет зависеть от одного облачного провайдера.

Решение: например, основной провайдер – AWS, резервный – Google Cloud.

Обоснование:
1. AWS предоставляет лучшие инструменты для ML-аналитики;
2. GCP – альтернатива для снижения рисков блокировки.

---

**ADR-3: Стратегия кеширования**

Необходимо снизить нагрузку на БД и ускорить ответы для часто запрашиваемых данных.

Решение: многоуровневая стратегия кеширования:
  - Redis для пользовательских сессий и метрик тренировок;
  - CDN для статического контента (изображения, видео);
  - Локальный кеш на мобильных устройствах;


Обоснование:
1. Redis обеспечивает время отклика <5 мс для 99% запросов;
2. Поддерживает кластеризацию и репликацию;
3. Имеет встроенные механизмы инвалидации кеша.

Последствия:
1. Необходимо реализовать механизм синхронизации кеша между сервисами;
2. Дополнительные затраты на инфраструктуру.

---

**ADR-4: Стратегия развертывания**

Требуется обеспечить бесперебойное обновление приложения для 1M+ пользователей.

Решение: Несколько окружений с canary-релизами.

Реализация:
  - Два идентичных production-окружения;
  - Маршрутизация через Istio;
  - Постепенный перевод трафика (15% → 50% → 100%);
  - Автоматический откат при ошибках (по метрикам Prometheus).

Преимущества:
1. Нулевое время простоя;
2. Возможность A/B тестирования функционала;
3. Минимизация риска при обновлениях.

Требования:
1. Поддержка Kubernetes;
2. Инфраструктура для хранения двух полных копий окружения.
